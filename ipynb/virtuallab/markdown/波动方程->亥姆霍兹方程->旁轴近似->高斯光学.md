```
你做为一个老师，详细讲述一下1. 波动方程到亥姆霍兹方程的推导。 2. 亥姆霍兹方程旁轴近似的推导。 3. 借助旁轴近似的结果，推导出Beam divergence， Rayleigh distance，Gouy phase 的公式。一定要注意推导先后的因果关系，在推导方程的时候不要使用后面待证明的结论。
```
---

你好！我是你的物理老师。很高兴能为你详细梳理这一连串优美的光学推导。

我们要走的是一条从**一般性**到**特殊性**，再从**方程**到**物理特性**的逻辑之路。我们将严格遵循因果关系：先有方程，再有近似，最后求解方程得到具体的物理参数。

这堂课我们将分为三个部分：
1.  **从波动方程出发，得到频率域的亥姆霍兹方程。**
2.  **引入“光束”的概念，利用旁轴近似简化方程。**
3.  **求解旁轴方程得到基模高斯光束，并由此导出光斑发散角、瑞利距离和 Gouy 相移。**

---

### 第一部分：从波动方程到亥姆霍兹方程 (Helmholtz Equation)

一切的起点是麦克斯韦方程组导出的标量波动方程。假设我们要研究真空中传播的电磁波，其电场分量 $E(\mathbf{r}, t)$ 满足如下波动方程：

$$\nabla^2 E - \frac{1}{c^2} \frac{\partial^2 E}{\partial t^2} = 0$$

这里的 $c$ 是光速。

#### 1. 分离变量（单色波假设）
在激光光学的研究中，我们通常处理的是**单色光**（或准单色光），即频率 $\omega$ 是单一的。我们可以将时间变量和空间变量分离。设解的形式为：

$$E(\mathbf{r}, t) = U(\mathbf{r}) e^{-i\omega t}$$

其中 $U(\mathbf{r})$ 是仅与空间位置有关的复振幅。

#### 2. 代入波动方程
我们需要计算时间偏导项：
$$\frac{\partial E}{\partial t} = -i\omega U(\mathbf{r}) e^{-i\omega t}$$
$$\frac{\partial^2 E}{\partial t^2} = (-i\omega)^2 U(\mathbf{r}) e^{-i\omega t} = -\omega^2 U(\mathbf{r}) e^{-i\omega t}$$

将这一项代入原始波动方程：
$$\nabla^2 (U(\mathbf{r}) e^{-i\omega t}) - \frac{1}{c^2} (-\omega^2 U(\mathbf{r}) e^{-i\omega t}) = 0$$

消去公共的时间因子 $e^{-i\omega t}$，得到：
$$\nabla^2 U(\mathbf{r}) + \frac{\omega^2}{c^2} U(\mathbf{r}) = 0$$

#### 3. 引入波数
我们定义波数 $k = \frac{\omega}{c} = \frac{2\pi}{\lambda}$。于是，我们得到了不含时间的**亥姆霍兹方程**：

$$\nabla^2 U + k^2 U = 0$$

> **老师的总结：** 亥姆霍兹方程本质上就是去除了时间依赖性的波动方程，它描述了单色波在空间中的稳态分布。

---

### 第二部分：亥姆霍兹方程的旁轴近似 (Paraxial Approximation)

亥姆霍兹方程的精确解包含球面波等形式。但在激光物理中，我们通常关心的是**光束**。光束的特点是：光主要沿一个方向（设为 $z$ 轴）传播，能量集中在轴附近。

#### 1. 剥离快速变化的相位因子
既然光主要向 $z$ 方向传播，我们可以把复振幅 $U(\mathbf{r})$ 写成一个沿 $z$ 轴传播的平面波因子与一个“缓慢变化”的包络函数 $A(x, y, z)$ 的乘积：

$$U(x, y, z) = A(x, y, z) e^{ikz}$$

#### 2. 代入亥姆霍兹方程
我们需要计算 $\nabla^2 U = \frac{\partial^2 U}{\partial x^2} + \frac{\partial^2 U}{\partial y^2} + \frac{\partial^2 U}{\partial z^2}$。

* **横向导数** ($\nabla_T^2 = \partial_x^2 + \partial_y^2$)：
    $$\nabla_T^2 U = e^{ikz} \nabla_T^2 A$$

* **纵向导数** ($z$ 方向，注意乘积法则)：
    $$\frac{\partial U}{\partial z} = \frac{\partial A}{\partial z} e^{ikz} + ikA e^{ikz} = \left( \frac{\partial A}{\partial z} + ikA \right) e^{ikz}$$
    $$\frac{\partial^2 U}{\partial z^2} = \frac{\partial}{\partial z}\left[ \left( \frac{\partial A}{\partial z} + ikA \right) e^{ikz} \right]$$
    $$= \left( \frac{\partial^2 A}{\partial z^2} + ik \frac{\partial A}{\partial z} \right) e^{ikz} + ik \left( \frac{\partial A}{\partial z} + ikA \right) e^{ikz}$$
    $$= \left( \frac{\partial^2 A}{\partial z^2} + 2ik \frac{\partial A}{\partial z} - k^2 A \right) e^{ikz}$$

现在，将横向和纵向结果代回亥姆霍兹方程 $\nabla^2 U + k^2 U = 0$：
$$\left[ \nabla_T^2 A + \left( \frac{\partial^2 A}{\partial z^2} + 2ik \frac{\partial A}{\partial z} - k^2 A \right) + k^2 A \right] e^{ikz} = 0$$

可以看到 $-k^2 A$ 和 $+k^2 A$ 相互抵消，得到精确方程：
$$\nabla_T^2 A + 2ik \frac{\partial A}{\partial z} + \frac{\partial^2 A}{\partial z^2} = 0$$

#### 3. 应用“缓变包络近似” (SVEA)
这里是物理直觉发挥作用的地方。因为是“光束”，其包络 $A$ 随 $z$ 的变化（光斑发散）远慢于光波本身的振荡（波长尺度）。
数学上，这意味着 $A$ 对 $z$ 的二阶导数远小于一阶导数与 $k$ 的乘积：

$$\left| \frac{\partial^2 A}{\partial z^2} \right| \ll \left| 2k \frac{\partial A}{\partial z} \right|$$

因此，我们可以忽略 $\frac{\partial^2 A}{\partial z^2}$ 这一项。

#### 4. 得到旁轴亥姆霍兹方程
最终我们得到描述激光光束传播的核心方程：

$$\nabla_T^2 A + 2ik \frac{\partial A}{\partial z} = 0$$

> **老师的总结：** 这个方程将原本的椭圆型偏微分方程（亥姆霍兹）近似为了抛物型偏微分方程（类似于薛定谔方程或热传导方程），大大简化了求解难度。

---

### 第三部分：从旁轴方程解导出光束参数

现在我们要通过解这个方程来定义物理量。我们不直接把高斯光束公式拿来用，而是验证一种形式的解，从而自然地引出那些参数。

我们寻找一个轴对称的解。试探解的形式设为：
$$A(r, z) = \frac{A_0}{q(z)} \exp\left( -ik \frac{r^2}{2q(z)} \right)$$
其中 $r^2 = x^2 + y^2$，而 $q(z)$ 是一个待定的复数函数，我们称之为**复光束参数 (Complex Beam Parameter)**。

*(注：将此试探解代入旁轴方程，经过数学运算可以证明，只要满足 $q'(z)=1$，该形式即为方程的解。因此 $q(z) = z + q_0$。)*

为了让这个数学解具有物理意义（描述一个光能量集中在轴附近的光束），$q(z)$ 必须包含虚部。我们**定义** $1/q(z)$ 的实部和虚部如下：

$$\frac{1}{q(z)} = \frac{1}{R(z)} - i \frac{\lambda}{\pi w^2(z)}$$

这里引入了两个实函数 $R(z)$ 和 $w(z)$，目前的阶段它们还只是数学代换。
将 $q(z) = z + i z_R$ （假设 $z=0$ 处为束腰，即虚部为常数 $z_R$）代入上式，我们开始推导三个核心参数。

#### 1. 推导瑞利距离 (Rayleigh Distance, $z_R$)

在 $z=0$ 处，波前曲率半径 $R(z) \to \infty$（平面波前），此时 $q(0)$ 必须是纯虚数。设束腰半径为 $w_0$，由定义的虚部关系：
$$\frac{1}{q(0)} = -i \frac{\lambda}{\pi w_0^2} \implies q(0) = i \frac{\pi w_0^2}{\lambda}$$

我们定义这个特定的长度为**瑞利距离 $z_R$**：
$$z_R \equiv \frac{\pi w_0^2}{\lambda}$$

所以，$q(z)$ 的具体表达式为：
$$q(z) = z + i z_R$$

> **结论：** 瑞利距离 $z_R$ 是由光束的束腰半径 $w_0$ 和波长 $\lambda$ 决定的特征长度，它标志着光束从“近场”转变为“远场”的分界线。

#### 2. 推导光束发散角 (Beam Divergence)

利用 $q(z) = z + i z_R$，我们来求 $w(z)$ 的显式表达式。
由定义 $\frac{1}{q(z)} = \frac{1}{z + i z_R} = \frac{z - i z_R}{z^2 + z_R^2}$。
对比我们之前定义的虚部：
$$\text{Im}\left( \frac{1}{q(z)} \right) = - \frac{z_R}{z^2 + z_R^2} = - \frac{\lambda}{\pi w^2(z)}$$

将 $z_R = \pi w_0^2 / \lambda$ 代入右边分子，整理得到：
$$w^2(z) = w_0^2 \left( 1 + \left(\frac{z}{z_R}\right)^2 \right) \implies w(z) = w_0 \sqrt{1 + \left(\frac{z}{z_R}\right)^2}$$

现在推导发散角 $\theta$。当 $z \gg z_R$（远场）时：
$$w(z) \approx w_0 \frac{z}{z_R}$$
发散半角定义为光斑半径随距离的变化率：
$$ \theta \approx \tan(\theta) = \frac{w(z)}{z} = \frac{w_0}{z_R}$$

代入 $z_R$ 的公式：
$$\theta = \frac{w_0}{\pi w_0^2 / \lambda} = \frac{\lambda}{\pi w_0}$$

> **结论：** 发散角 $\theta = \frac{\lambda}{\pi w_0}$。这体现了衍射极限：束腰 $w_0$ 越小，发散角 $\theta$ 越大。

#### 3. 推导 Gouy 相移 (Gouy Phase)

让我们回到复振幅 $A(r, z)$ 的表达式，特别是前面的归一化因子 $1/q(z)$。
$$A(r, z) \propto \frac{1}{q(z)} = \frac{1}{z + i z_R}$$

我们需要分离出振幅和相位。将复数 $z + i z_R$ 写成极坐标形式：
$$z + i z_R = \sqrt{z^2 + z_R^2} \cdot e^{i \psi(z)}$$
其中相位角 $\psi(z)$ 满足 $\tan \psi(z) = \frac{z_R}{z}$。通常我们定义 Gouy 相移为 $\zeta(z)$，习惯上利用 $\arctan(z/z_R)$ 的形式。

注意到 $\frac{1}{z + i z_R}$ 位于分母，其相位因子为 $e^{-i \psi(z)}$。
$$\psi(z) = \arctan\left(\frac{z_R}{z}\right)$$
而在光学习惯中，我们通常将 $z=0$ 处的相位定为参考点，并且使用 $\arctan(z/z_R)$ 的形式。利用数学恒等式 $\arctan(1/x) = \pi/2 - \arctan(x)$ (for $x>0$)，这只是一个常数相位差。

更标准的推导是将 $1/q(z)$ 写作：
$$\frac{1}{z + i z_R} = \frac{1}{\sqrt{z^2 + z_R^2}} \exp\left( -i \arctan\frac{z_R}{z} \right)$$
或者更常见的形式（为了让 $z \to \infty$ 时相位连续变化），我们将这一项带来的**额外相移**（相对于平面波 $kz$ 之外的相移）称为 Gouy 相移 $\zeta(z)$。

由此导出的总电场表达式中，相位项包含：
$$\exp\left( i [kz - \zeta(z)] \right)$$
其中：
$$\zeta(z) = \arctan\left(\frac{z}{z_R}\right)$$

*(注：这里的正负号取决于具体 $q$ 参数的定义习惯，但物理本质是：光束通过焦点时，相比于平面波，会多产生一个 $\pi$ 的相位滑移。)*

> **结论：** Gouy 相移 $\zeta(z) = \arctan(z/z_R)$ 来源于 $1/q(z)$ 这一项的复数性质，它反映了光束被横向限制（空间压缩）导致的轴向相速度增加。

---

### 总结 (Next Step)

通过这一系列的推导，我们完成了一个完整的逻辑闭环：
1.  **波动方程** $\xrightarrow{\text{去时间}}$ **亥姆霍兹方程**
2.  **亥姆霍兹方程** $\xrightarrow{\text{SVEA近似}}$ **旁轴方程**
3.  **旁轴方程** $\xrightarrow{\text{高斯试探解}}$ **复参数 $q(z)$**
4.  **$q(z)$ 的实部与虚部** $\rightarrow$ **$z_R, \theta, \zeta(z)$**
